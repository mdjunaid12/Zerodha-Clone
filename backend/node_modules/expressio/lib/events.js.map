{"version":3,"sources":["../src/events.js"],"names":["server","stack","on","event","fn","ndtk","assert","length","emit","args","events","Promise","all","map"],"mappings":";;;;;;;AAQA;;AACA;;AACA;;;;AAVA;;;;;;;eAYgBA,MAAD,IAAY;AACzB,QAAMC,KAAK,GAAG,EAAd;AAEA;;;;AAGA,QAAMC,EAAE,GAAG,CAACC,KAAD,EAAQC,EAAR,KAAe;AACxBC,kBAAKC,MAAL,CAAY,uBAASH,KAAT,KAAmBA,KAAK,CAACI,MAAN,KAAiB,CAAhD,EAAmD,qCAAnD;;AACAF,kBAAKC,MAAL,CAAY,yBAAWF,EAAX,CAAZ,EAA6B,kBAAiBD,KAAM,kCAApD;;AAEA,QAAI,CAACF,KAAK,CAACE,KAAD,CAAV,EAAmBF,KAAK,CAACE,KAAD,CAAL,GAAe,CAACC,EAAD,CAAf,CAAnB,KACKH,KAAK,CAACE,KAAD,CAAL,GAAe,CAAC,GAAGF,KAAK,CAACE,KAAD,CAAT,EAAkBC,EAAlB,CAAf;AACN,GAND;AAQA;;;;;AAGA,QAAMI,IAAI,GAAG,CAACL,KAAD,EAAQ,GAAGM,IAAX,KAAoB;AAC/BJ,kBAAKC,MAAL,CAAY,uBAASH,KAAT,KAAmBA,KAAK,CAACI,MAAN,KAAiB,CAAhD,EAAmD,qCAAnD;;AAEA,UAAMG,MAAM,GAAGT,KAAK,CAACE,KAAD,CAAL,IAAgB,EAA/B;AAEA,WAAOQ,OAAO,CAACC,GAAR,CAAYF,MAAM,CAACG,GAAP,CAAWT,EAAE,IAAIA,EAAE,CAACJ,MAAD,EAAS,GAAGS,IAAZ,CAAnB,CAAZ,CAAP;AACD,GAND,CAjByB,CAyBzB;;;AACAT,EAAAA,MAAM,CAACU,MAAP,GAAgB;AAAER,IAAAA,EAAF;AAAMM,IAAAA;AAAN,GAAhB;AACD,C","sourcesContent":["/**\n * Async Events\n *\n * @copyright Copyright (c) 2018, hugw.io\n * @author Hugo W - contact@hugw.io\n * @license MIT\n */\n\nimport isString from 'lodash/isString'\nimport isFunction from 'lodash/isFunction'\nimport ndtk from 'ndtk'\n\nexport default (server) => {\n  const stack = {}\n\n  /**\n   * Register new events\n   */\n  const on = (event, fn) => {\n    ndtk.assert(isString(event) && event.length !== 0, 'Events error: event is not a string')\n    ndtk.assert(isFunction(fn), `Events error: \"${event}\" event has not a valid function`)\n\n    if (!stack[event]) stack[event] = [fn]\n    else stack[event] = [...stack[event], fn]\n  }\n\n  /**\n   * Emit events\n   */\n  const emit = (event, ...args) => {\n    ndtk.assert(isString(event) && event.length !== 0, 'Events error: event is not a string')\n\n    const events = stack[event] || []\n\n    return Promise.all(events.map(fn => fn(server, ...args)))\n  }\n\n  // Expose Events Api to the server object\n  server.events = { on, emit }\n}\n"],"file":"events.js"}